魏明帝御驾西进坐镇长安，命令张郃率军抵御诸葛亮，诸葛亮派遣马谡督率各军前行，与张郃大战于街亭。